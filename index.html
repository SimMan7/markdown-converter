<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <!-- SEO Meta Tags -->
  <title>Markdown to PDF Converter - Free Online Tool | Convert Markdown to PDF & Word</title>
  <meta name="description" content="Free online Markdown to PDF converter. Convert your Markdown files to PDF, Word documents, and preview them instantly. No registration required. Fast, secure, and mobile-friendly." />
  <meta name="keywords" content="markdown to pdf converter, markdown preview online, markdown to word, markdown editor, pdf converter, document converter" />
  <meta name="author" content="MarkdownConverter" />
  <meta name="robots" content="index, follow" />
  
  <!-- Open Graph Meta Tags -->
  <meta property="og:title" content="Markdown to PDF Converter - Free Online Tool" />
  <meta property="og:description" content="Convert Markdown files to PDF and Word documents instantly. Free online tool with real-time preview." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.convertmdtopdf.online" />
  <meta property="og:image" content="https://www.convertmdtopdf.online/static/images/markdown-converter-preview.png" />
  
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Markdown to PDF Converter - Free Online Tool" />
  <meta name="twitter:description" content="Convert Markdown files to PDF and Word documents instantly. Free online tool with real-time preview." />
  <meta name="twitter:image" content="https://www.convertmdtopdf.online/static/images/markdown-converter-preview.png" />
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://www.convertmdtopdf.online" />
  
  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6865885814212781"
       crossorigin="anonymous"></script>
  
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QFVT5ZXLQ2"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-QFVT5ZXLQ2');
  </script>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.5;
      color: #333;
      background-color: #f8f9fa;
    }
    
    .container {
      max-width: 900px;
      margin: 0 auto;
      padding: 0 20px;
    }
    
    /* Header */
    header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 2rem 0;
      text-align: center;
    }
    header h1 {
      font-size: 2.2rem;
      margin-bottom: 1rem;
      font-weight: 700;
    }
    header p {
      font-size: 1rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
    }
    
    main {
      padding: 3rem 0;
    }
    
    /* SEO Landing Content */
    .hero-section {
      text-align: center;
      margin-bottom: 3rem;
    }
    .hero-section h2 {
      font-size: 1.75rem;
      color: #2c3e50;
      margin-bottom: 1rem;
    }
    .hero-section p {
      font-size: 1rem;
      color: #666;
      max-width: 700px;
      margin: 0 auto 2rem;
    }
    
    .cta-button {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.8rem 1.8rem;
      text-decoration: none;
      border-radius: 35px;
      font-weight: 600;
      font-size: 1rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    .cta-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
      color: white;
    }
    
    .features-section {
      margin-bottom: 3rem;
    }
    .features-section h2 {
      text-align: center;
      font-size: 1.75rem;
      color: #2c3e50;
      margin-bottom: 3rem;
    }
    .features-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
    }
    .feature-card {
      background: white;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
    .feature-card:hover {
      transform: translateY(-5px);
    }
    .feature-card h3 {
      color: #2c3e50;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }
    .feature-card p {
      color: #666;
      line-height: 1.6;
      font-size: 0.9rem;
    }
    
    .how-it-works {
      background: white;
      padding: 3rem 0;
      margin: 3rem 0;
    }
    .how-it-works h2 {
      text-align: center;
      font-size: 1.75rem;
      color: #2c3e50;
      margin-bottom: 3rem;
    }
    .steps {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 2rem;
      max-width: 900px;
      margin: 0 auto;
    }
    .step {
      text-align: center;
      padding: 1.5rem;
    }
    .step-number {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 1.2rem;
      margin: 0 auto 1rem;
    }
    .step h3 {
      color: #2c3e50;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }
    .step p {
      color: #666;
      font-size: 0.9rem;
    }
    
    .image-section {
      text-align: center;
      margin: 3rem 0;
    }
    .converter-image {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
      margin-bottom: 1rem;
    }
    
    /* Ad sidebars */
    #ad-left, #ad-right {
      position: fixed;
      top: 100px;
      width: 160px;
      height: 600px;
      background-color: #f1f1f1;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
      border-radius: 8px;
      padding: 15px;
      font-size: 0.85rem;
      overflow: auto;
      z-index: 10;
    }
    #ad-left {
      left: 10px;
    }
    #ad-right {
      right: 10px;
    }
    
    /* Ad contact forms */
    #ad-left form, #ad-right form {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    #ad-left h4, #ad-right h4 {
      font-size: 1rem;
      margin-bottom: 10px;
      color: #2c3e50;
      text-align: center;
    }
    #ad-left label, #ad-right label {
      font-size: 0.8rem;
      font-weight: 600;
      color: #333;
    }
    #ad-left input, #ad-right input,
    #ad-left textarea, #ad-right textarea {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 0.8rem;
    }
    #ad-left button, #ad-right button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      font-size: 0.8rem;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    #ad-left button:hover, #ad-right button:hover {
      transform: translateY(-1px);
    }
    #ad-left p, #ad-right p {
      font-size: 0.75rem;
      margin-top: 8px;
      text-align: center;
      min-height: 20px;
    }
    #ad-left .g-recaptcha, #ad-right .g-recaptcha {
      transform: scale(0.8);
      transform-origin: left top;
      margin: 5px 0;
    }
    
    /* Hide ads on small screens */
    @media (max-width: 1024px) {
      #ad-left, #ad-right {
        display: none;
      }
      .container {
        max-width: 100%;
        padding: 0 10px;
      }
    }
    
    /* Converter UI prominence */
    #converter-container {
      background: white;
      padding: 3rem 3rem 4rem 3rem;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.15);
      margin: 5rem auto 3rem auto;
      max-width: 900px;
      font-size: 1.1rem;
    }
    #converter-container h2 {
      font-size: 2rem;
      margin-bottom: 1.5rem;
      text-align: center;
      color: #2c3e50;
    }
    #converter-container p {
      margin-bottom: 1.5rem;
      text-align: center;
      color: #666;
    }
    
    .upload-area {
      border: 2px dashed #667eea;
      border-radius: 10px;
      padding: 2rem;
      text-align: center;
      margin-bottom: 2rem;
      transition: all 0.3s ease;
      background: #f8f9ff;
    }
    .upload-area:hover {
      border-color: #764ba2;
      background: #f0f2ff;
    }
    .upload-area.dragover {
      border-color: #764ba2;
      background: #e8f0ff;
      transform: scale(1.02);
    }
    
    .file-input {
      display: none;
    }
    .file-label {
      display: inline-block;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1rem 2rem;
      border-radius: 50px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1.1rem;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
    }
    .file-label:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
    }
    
    .convert-btn {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      border: none;
      padding: 0.8rem 1.8rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 1.1rem;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 4px 15px rgba(40, 167, 69, 0.4);
      margin-top: 1rem;
    }
    .convert-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(40, 167, 69, 0.6);
    }
    .convert-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    
    .file-info {
      margin: 1rem 0;
      padding: 1rem;
      background: #e9ecef;
      border-radius: 8px;
      display: none;
    }
    .file-info.show {
      display: block;
    }
    
    .output-area {
      margin-top: 2rem;
      padding: 2rem;
      background: #f8f9fa;
      border-radius: 10px;
      border: 1px solid #dee2e6;
      display: none;
    }
    .output-area.show {
      display: block;
    }
    
    .download-buttons {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    .download-btn {
      background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      text-decoration: none;
      display: inline-block;
      font-size: 1.1rem;
    }
    .download-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(220, 53, 69, 0.4);
      color: white;
    }
    .download-btn.word {
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
    }
    .download-btn.word:hover {
      box-shadow: 0 4px 15px rgba(0, 123, 255, 0.4);
    }
    .download-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    .download-btn:disabled:hover {
      transform: none;
      box-shadow: none;
    }
    
    .preview-content {
      background: white;
      padding: 1.5rem;
      border-radius: 8px;
      border: 1px solid #dee2e6;
      margin-top: 1rem;
      max-height: 400px;
      overflow-y: auto;
    }
    
    footer {
      background: #2c3e50;
      color: white;
      text-align: center;
      padding: 2rem 0;
      margin-top: 3rem;
    }
    footer p {
      opacity: 0.8;
    }
    
    .sr-only {
      position: absolute;
      width: 1px;
      height: 1px;
      padding: 0;
      margin: -1px;
      overflow: hidden;
      clip: rect(0, 0, 0, 0);
      white-space: nowrap;
      border: 0;
    }
    
    a:focus, button:focus, input:focus {
      outline: 2px solid #667eea;
      outline-offset: 2px;
    }
    
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid #f3f3f3;
      border-top: 3px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-left: 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>

  <!-- Schema Markup -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Markdown to PDF Converter",
    "description": "Free online tool to convert Markdown files to PDF and Word documents with real-time preview",
    "url": "https://www.convertmdtopdf.online",
    "applicationCategory": "ProductivityApplication",
    "operatingSystem": "Web Browser",
    "browserRequirements": "Requires JavaScript. Requires HTML5.",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "featureList": [
      "Markdown to PDF conversion",
      "Markdown to Word conversion",
      "Real-time markdown preview",
      "Drag and drop file upload",
      "Mobile-friendly interface",
      "No registration required"
    ],
    "keywords": "markdown to pdf converter, markdown preview online, markdown to word, document converter",
    "author": {
      "@type": "Organization",
      "name": "MarkdownConverter"
    },
    "aggregateRating": {
      "@type": "AggregateRating",
      "ratingValue": "4.8",
      "ratingCount": "150"
    }
  }
  </script>
</head>
<body>
  <!-- Left Ad Sidebar -->
  <div id="ad-left" aria-label="Advertisement space left sidebar">
    <form id="ad-contact-form-left" onsubmit="return handleSubmit(event, 'left')" aria-label="Advertiser contact form left">
      <h4>Advertise Here</h4>
      <label for="name-left">Name*</label><br/>
      <input type="text" id="name-left" name="name" required autocomplete="name" /><br/>

      <label for="email-left">Email*</label><br/>
      <input type="email" id="email-left" name="email" required autocomplete="email" /><br/>

      <label for="company-left">Company</label><br/>
      <input type="text" id="company-left" name="company" autocomplete="organization" /><br/>

      <label for="message-left">Message*</label><br/>
      <textarea id="message-left" name="message" required rows="3"></textarea><br/>

      <!-- Honeypot field (hidden) -->
      <input type="text" name="phone" style="display:none" tabindex="-1" autocomplete="off" />

      <!-- Google reCAPTCHA v2 -->
      <div class="g-recaptcha" data-sitekey="6LeSYJ0rAAAAAGoQ268L0NVN6mg-VZoHdN0nQGoh"></div>

      <button type="submit">Send Inquiry</button>

      <p id="form-status-left" aria-live="polite"></p>
    </form>
  </div>

  <!-- Right Ad Sidebar -->
  <div id="ad-right" aria-label="Advertisement space right sidebar">
    <form id="ad-contact-form-right" onsubmit="return handleSubmit(event, 'right')" aria-label="Advertiser contact form right">
      <h4>Advertise Here</h4>
      <label for="name-right">Name*</label><br/>
      <input type="text" id="name-right" name="name" required autocomplete="name" /><br/>

      <label for="email-right">Email*</label><br/>
      <input type="email" id="email-right" name="email" required autocomplete="email" /><br/>

      <label for="company-right">Company</label><br/>
      <input type="text" id="company-right" name="company" autocomplete="organization" /><br/>

      <label for="message-right">Message*</label><br/>
      <textarea id="message-right" name="message" required rows="3"></textarea><br/>

      <!-- Honeypot field (hidden) -->
      <input type="text" name="phone" style="display:none" tabindex="-1" autocomplete="off" />

      <!-- Google reCAPTCHA v2 -->
      <div class="g-recaptcha" data-sitekey="6LeSYJ0rAAAAAGoQ268L0NVN6mg-VZoHdN0nQGoh"></div>

      <button type="submit">Send Inquiry</button>

      <p id="form-status-right" aria-live="polite"></p>
    </form>
  </div>

  <header>
    <div class="container">
      <h1>Markdown to PDF Converter</h1>
      <p>Convert your Markdown files to PDF and Word documents instantly. Free online tool with real-time preview and no registration required.</p>
    </div>
  </header>

  <main>
    <div class="container">
      <section class="hero-section" id="landing-hero">
        <h2>Free Online Markdown to PDF Converter</h2>
        <p>Transform your Markdown documents into professional PDF files and Word documents with our easy-to-use online converter. Perfect for developers, writers, and anyone who works with Markdown files.</p>
        <a href="#converter-container" class="cta-button">Start Converting Now</a>
      </section>

      <section class="features-section" id="landing-features">
        <h2>Why Choose Our Markdown to PDF Converter?</h2>
        <div class="features-grid">
          <article class="feature-card">
            <h3>Real-time Markdown Preview</h3>
            <p>See your Markdown content rendered instantly as you upload. Our markdown preview online feature lets you verify formatting before conversion.</p>
          </article>
          <article class="feature-card">
            <h3>Multiple Export Formats</h3>
            <p>Convert Markdown to PDF with professional styling, or export to Word documents (.docx) for further editing. Choose the format that works best for your needs.</p>
          </article>
          <article class="feature-card">
            <h3>Drag & Drop Interface</h3>
            <p>Simply drag your Markdown files onto our converter or click to browse. No complex setup required - just upload and convert.</p>
          </article>
          <article class="feature-card">
            <h3>Mobile-Friendly Design</h3>
            <p>Our Markdown to PDF converter works perfectly on all devices. Convert files on your phone, tablet, or desktop with the same ease.</p>
          </article>
          <article class="feature-card">
            <h3>No Registration Required</h3>
            <p>Start converting immediately without creating an account. Your files are processed securely and automatically cleaned up after conversion.</p>
          </article>
          <article class="feature-card">
            <h3>Fast & Secure</h3>
            <p>Our markdown to word converter processes files quickly and securely. Your documents are never stored permanently on our servers.</p>
          </article>
        </div>
      </section>

      <section class="how-it-works" id="landing-how-it-works">
        <h2>How to Convert Markdown to PDF</h2>
        <div class="steps">
          <div class="step">
            <div class="step-number">1</div>
            <h3>Upload Your File</h3>
            <p>Drag and drop your Markdown file (.md or .markdown) or click to browse and select your file.</p>
          </div>
          <div class="step">
            <div class="step-number">2</div>
            <h3>Preview & Verify</h3>
            <p>See your Markdown rendered in real-time. Our markdown preview online feature ensures your formatting looks perfect.</p>
          </div>
          <div class="step">
            <div class="step-number">3</div>
            <h3>Download Your File</h3>
            <p>Choose to download as PDF or Word document. Your converted file is ready instantly.</p>
          </div>
        </div>
      </section>

      <section class="image-section" id="landing-image">
        <h2>Professional Markdown to PDF Conversion</h2>
        <img src="{{ url_for('static', filename='images/markdown-converter-preview.png') }}" alt="Markdown to PDF converter interface showing file upload and preview functionality" class="converter-image" loading="lazy" />
        <p>Our markdown to word converter provides a clean, intuitive interface for all your document conversion needs.</p>
      </section>

      <section class="features-section" id="landing-supported-features">
        <h2>Supported Markdown Features</h2>
        <div class="features-grid">
          <article class="feature-card">
            <h3>Text Formatting</h3>
            <p>Bold, italic, strikethrough, and code formatting are all preserved when converting Markdown to PDF.</p>
          </article>
          <article class="feature-card">
            <h3>Headers & Structure</h3>
            <p>All heading levels (H1-H6) are properly converted, maintaining your document's hierarchy in the final PDF.</p>
          </article>
          <article class="feature-card">
            <h3>Lists & Tables</h3>
            <p>Ordered and unordered lists, as well as tables, are perfectly formatted in your converted documents.</p>
          </article>
          <article class="feature-card">
            <h3>Code Blocks</h3>
            <p>Syntax highlighting and code blocks are preserved when converting Markdown to Word or PDF formats.</p>
          </article>
          <article class="feature-card">
            <h3>Links & Images</h3>
            <p>Hyperlinks and images are maintained in your converted documents, ensuring all content is preserved.</p>
          </article>
          <article class="feature-card">
            <h3>Blockquotes</h3>
            <p>Blockquotes and special formatting are properly styled in your final PDF and Word documents.</p>
          </article>
        </div>
      </section>

      <section class="ai-conversion-section" id="landing-ai-conversion" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 3rem 0; margin: 3rem 0; border-radius: 12px;">
        <div class="container">
          <div style="text-align: center; max-width: 800px; margin: 0 auto;">
            <h2 style="font-size: 1.75rem; margin-bottom: 1.5rem; color: white;">Frustrated with AI Platform PDF Conversions?</h2>
            <p style="font-size: 1.1rem; margin-bottom: 2rem; opacity: 0.95;">
              If you keep getting Markdown files from AI platforms like ChatGPT, Claude, or other AI tools and you're unhappy with their PDF conversion quality, use our website to convert your Markdown to professional PDF or Word documents for free.
            </p>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-top: 2rem;">
              <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 8px; backdrop-filter: blur(10px);">
                <h3 style="font-size: 1.2rem; margin-bottom: 1rem;">Better Quality</h3>
                <p style="font-size: 0.95rem; opacity: 0.9;">Professional formatting that preserves your document structure and styling better than AI platform exports.</p>
              </div>
              <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 8px; backdrop-filter: blur(10px);">
                <h3 style="font-size: 1.2rem; margin-bottom: 1rem;">Multiple Formats</h3>
                <p style="font-size: 0.95rem; opacity: 0.9;">Convert to both PDF and Word (.docx) formats for maximum compatibility and editing flexibility.</p>
              </div>
              <div style="background: rgba(255,255,255,0.1); padding: 1.5rem; border-radius: 8px; backdrop-filter: blur(10px);">
                <h3 style="font-size: 1.2rem; margin-bottom: 1rem;">Completely Free</h3>
                <p style="font-size: 0.95rem; opacity: 0.9;">No registration required, no hidden fees, no watermarks - just high-quality conversions at no cost.</p>
              </div>
            </div>
            <a href="#converter-container" class="cta-button" style="margin-top: 2rem; background: white; color: #667eea; font-weight: 700; padding: 1rem 2rem; border-radius: 50px; text-decoration: none; display: inline-block; transition: transform 0.3s ease, box-shadow 0.3s ease; box-shadow: 0 4px 15px rgba(255,255,255,0.3);">
              Convert Your AI-Generated Markdown Now
            </a>
          </div>
        </div>
      </section>

      <section id="converter-container" aria-label="Markdown to PDF Converter Interface">
        <h2>Markdown to PDF Converter Tool</h2>
        <p>Upload your Markdown file below to convert it to PDF or Word format:</p>
        
        <div class="upload-area" id="upload-area">
          <input type="file" id="markdown-file" name="markdown-file" accept=".md,.markdown" class="file-input" aria-label="Select Markdown file to upload" />
          <label for="markdown-file" class="file-label">Choose Markdown File</label>
          <p style="margin-top: 1rem; color: #666; font-size: 0.9rem;">Maximum file size: 16MB</p>
        </div>
        
        <div class="file-info" id="file-info">
          <strong>Selected file:</strong> <span id="file-name"></span>
          <br>
          <small>Size: <span id="file-size"></span></small>
        </div>
        
        <div style="text-align: center;">
          <button type="button" id="convert-btn" class="convert-btn" disabled>
            Convert to PDF/Word
            <span class="loading" id="loading-spinner" style="display: none;"></span>
          </button>
        </div>
        
        <div class="output-area" id="output-area">
          <h3>Preview</h3>
          <div class="preview-content" id="preview-content">
            {% if preview_content %}
              {{ preview_content | safe }}
            {% endif %}
          </div>
          <div class="download-buttons" id="download-buttons">
            {% if filename %}
              <button class="download-btn download-pdf" 
                      data-file-path="/api/download/pdf/{{ filename }}"
                      data-file-name="{{ original_filename | replace('.md', '') | replace('.markdown', '') }}">
                Download as PDF
              </button>

              <button class="download-btn word download-docx" 
                      data-file-path="/api/download/docx/{{ filename }}"
                      data-file-name="{{ original_filename | replace('.md', '') | replace('.markdown', '') }}">
                Download as Word
              </button>
            {% else %}
              <button class="download-btn download-pdf" disabled>Download as PDF</button>
              <button class="download-btn word download-docx" disabled>Download as Word</button>
            {% endif %}
          </div>
          {% if filename %}
            <div data-filename="{{ filename }}" style="display: none;"></div>
          {% endif %}
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="container">
      <p>&copy; 2025 MarkdownConverter. Free online Markdown to PDF converter tool.</p>
    </div>
  </footer>

  <!-- Google reCAPTCHA script -->
  <script src="https://www.google.com/recaptcha/api.js" async defer></script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const fileInput = document.getElementById('markdown-file');
      const uploadArea = document.getElementById('upload-area');
      const fileInfo = document.getElementById('file-info');
      const fileName = document.getElementById('file-name');
      const fileSize = document.getElementById('file-size');
      const convertBtn = document.getElementById('convert-btn');
      const loadingSpinner = document.getElementById('loading-spinner');
      const outputArea = document.getElementById('output-area');
      const previewContent = document.getElementById('preview-content');
      const downloadPdf = document.getElementById('download-pdf');
      const downloadWord = document.getElementById('download-word');

      uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        uploadArea.classList.add('dragover');
      });

      uploadArea.addEventListener('dragleave', function(e) {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
      });

      uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
          fileInput.files = files;
          handleFileSelect();
        }
      });

      fileInput.addEventListener('change', handleFileSelect);

      function handleFileSelect() {
        const file = fileInput.files[0];
        if (file) {
          const allowedTypes = ['.md', '.markdown'];
          const fileName = file.name.toLowerCase();
          const isValidType = allowedTypes.some(type => fileName.endsWith(type));
          
          if (!isValidType) {
            alert('Please select a valid Markdown file (.md or .markdown)');
            return;
          }

          const maxSize = 16 * 1024 * 1024;
          if (file.size > maxSize) {
            alert('File size exceeds 16MB limit. Please select a smaller file.');
            return;
          }

          document.getElementById('file-name').textContent = file.name;
          document.getElementById('file-size').textContent = formatFileSize(file.size);
          fileInfo.classList.add('show');
          convertBtn.disabled = false;
        }
      }

      function formatFileSize(bytes) {
        if (bytes === 0) return '0 Bytes';
        const k = 1024;
        const sizes = ['Bytes', 'KB', 'MB', 'GB'];
        const i = Math.floor(Math.log(bytes) / Math.log(k));
        return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
      }

      convertBtn.addEventListener('click', function() {
        const file = fileInput.files[0];
        if (!file) return;

        convertBtn.disabled = true;
        loadingSpinner.style.display = 'inline-block';

        // Create FormData for file upload
        const formData = new FormData();
        formData.append('file', file);

        // Upload file to server
        console.log('Uploading file to server...');
        fetch('/api/upload', {
          method: 'POST',
          body: formData
        })
        .then(response => {
          console.log('Upload response status:', response.status);
          if (!response.ok) {
            throw new Error('Upload failed: ' + response.status);
          }
          return response.json();
        })
        .then(data => {
          console.log('Upload response data:', data);
          
          if (!data.success) {
            throw new Error(data.error || 'Upload failed');
          }
          
          const filename = data.filename;
          console.log('Extracted filename:', filename);
          
          // Convert markdown to HTML for preview
          const reader = new FileReader();
          reader.onload = function(e) {
            const content = e.target.result;
            const htmlContent = convertMarkdownToHtml(content);
            previewContent.innerHTML = htmlContent;
          };
          reader.readAsText(file);
          
          outputArea.classList.add('show');
          convertBtn.disabled = false;
          loadingSpinner.style.display = 'none';
          
          // Set up download buttons with data attributes for direct download
          if (filename) {
            // Update the download buttons with proper data attributes
            const downloadPdfBtn = document.querySelector('.download-pdf');
            const downloadWordBtn = document.querySelector('.download-docx');
            
            if (downloadPdfBtn) {
              downloadPdfBtn.setAttribute('data-file-path', `/api/download/pdf/${filename}`);
              downloadPdfBtn.setAttribute('data-file-name', file.name.replace(/\.(md|markdown)$/i, ''));
              downloadPdfBtn.disabled = false;
            }
            
            if (downloadWordBtn) {
              downloadWordBtn.setAttribute('data-file-path', `/api/download/docx/${filename}`);
              downloadWordBtn.setAttribute('data-file-name', file.name.replace(/\.(md|markdown)$/i, ''));
              downloadWordBtn.disabled = false;
            }
            
            console.log('Download buttons set up with data attributes');
          }
        })
        .catch(error => {
          console.error('Upload error:', error);
          alert('Upload failed. Please try again.');
          convertBtn.disabled = false;
          loadingSpinner.style.display = 'none';
        });
      });

      function createStyledHtml(content, filename) {
        return `<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>${filename.replace(/\.(md|markdown)$/i, '')}</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            background-color: white;
        }
        h1, h2, h3, h4, h5, h6 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
            page-break-after: avoid;
        }
        h1 {
            font-size: 2.5rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }
        h2 {
            font-size: 2rem;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 8px;
        }
        h3 {
            font-size: 1.5rem;
            color: #495057;
        }
        p {
            margin-bottom: 1.2rem;
            text-align: justify;
        }
        code {
            background-color: #f8f9fa;
            color: #e83e8c;
            padding: 3px 6px;
            border-radius: 4px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
        }
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 16px;
            overflow-x: auto;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        pre code {
            background-color: transparent;
            padding: 0;
            color: #333;
        }
        blockquote {
            border-left: 4px solid #667eea;
            margin: 20px 0;
            padding: 10px 20px;
            color: #6c757d;
            font-style: italic;
            background-color: #f8f9fa;
            border-radius: 0 6px 6px 0;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 20px 0;
            font-size: 0.95rem;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        table th, table td {
            border: 1px solid #dee2e6;
            padding: 12px;
            text-align: left;
        }
        table th {
            background-color: #667eea;
            color: white;
            font-weight: 600;
        }
        table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        ul, ol {
            margin-bottom: 1.2rem;
            padding-left: 2.5rem;
        }
        li {
            margin-bottom: 0.5rem;
        }
        a {
            color: #667eea;
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        img {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            margin: 10px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        hr {
            border: none;
            border-top: 2px solid #e9ecef;
            margin: 30px 0;
        }
        @media print {
            body {
                margin: 0;
                padding: 20px;
                font-size: 12pt;
            }
            h1, h2, h3, h4, h5, h6 {
                page-break-after: avoid;
            }
            pre, blockquote, table {
                page-break-inside: avoid;
            }
            a {
                color: #000;
            }
        }
    </style>
</head>
<body>
    ${content}
</body>
</html>`;
      }

      // Direct download function - replaces querySelector approach
      function downloadFile(filePath, fileName, fileType = 'pdf') {
        try {
          const link = document.createElement('a');
          link.href = filePath;
          
          // Set appropriate filename with extension
          const extension = fileType === 'pdf' ? '.pdf' : '.docx';
          const downloadName = fileName ? 
            (fileName.endsWith(extension) ? fileName : fileName + extension) : 
            `converted-file${extension}`;
            
          link.download = downloadName;
          link.style.display = 'none';
          
          // Append, click, and remove
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          console.log(`Download initiated: ${downloadName}`);
        } catch (error) {
          console.error('Download failed:', error);
          alert('Download failed. Please try again.');
        }
      }

      // Enhanced version with progress feedback
      function downloadFileWithFeedback(filePath, fileName, fileType = 'pdf') {
        try {
          // Show loading state
          const downloadBtn = event.target;
          const originalText = downloadBtn.textContent;
          downloadBtn.textContent = 'Downloading...';
          downloadBtn.disabled = true;
          
          fetch(filePath)
            .then(response => {
              if (!response.ok) throw new Error('Download failed');
              return response.blob();
            })
            .then(blob => {
              const url = window.URL.createObjectURL(blob);
              const link = document.createElement('a');
              link.href = url;
              
              const extension = fileType === 'pdf' ? '.pdf' : '.docx';
              const downloadName = fileName ? 
                (fileName.endsWith(extension) ? fileName : fileName + extension) : 
                `converted-file${extension}`;
                
              link.download = downloadName;
              document.body.appendChild(link);
              link.click();
              
              // Cleanup
              document.body.removeChild(link);
              window.URL.revokeObjectURL(url);
            })
            .catch(error => {
              console.error('Download error:', error);
              alert('Download failed. Please try again.');
            })
            .finally(() => {
              // Reset button state
              downloadBtn.textContent = originalText;
              downloadBtn.disabled = false;
            });
            
        } catch (error) {
          console.error('Download failed:', error);
          alert('Download failed. Please try again.');
        }
      }

      function convertMarkdownToHtml(markdown) {
        let html = markdown
          .replace(/^### (.*$)/gim, '<h3>$1</h3>')
          .replace(/^## (.*$)/gim, '<h2>$1</h2>')
          .replace(/^# (.*$)/gim, '<h1>$1</h1>')
          .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
          .replace(/\*(.*?)\*/g, '<em>$1</em>')
          .replace(/```([\s\S]*?)```/g, '<pre><code>$1</code></pre>')
          .replace(/`(.*?)`/g, '<code>$1</code>')
          .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>')
          .replace(/^\* (.*$)/gim, '<li>$1</li>')
          .replace(/^- (.*$)/gim, '<li>$1</li>')
          .replace(/\n\n/g, '</p><p>')
          .replace(/^(?!<[h|li|pre|p]).*$/gim, '<p>$&</p>');

        html = html.replace(/<li>.*<\/li>/g, function(match) {
          return '<ul>' + match + '</ul>';
        });

        return html;
      }

      // Global download event handler - replaces querySelector approach
      document.addEventListener('click', function(event) {
        if (event.target.classList.contains('download-pdf')) {
          event.preventDefault();
          const filePath = event.target.getAttribute('data-file-path') || event.target.href;
          const fileName = event.target.getAttribute('data-file-name') || 'converted-document';
          
          downloadFile(filePath, fileName, 'pdf');
        }
        
        if (event.target.classList.contains('download-docx')) {
          event.preventDefault();
          const filePath = event.target.getAttribute('data-file-path') || event.target.href;
          const fileName = event.target.getAttribute('data-file-name') || 'converted-document';
          
          downloadFile(filePath, fileName, 'docx');
        }
      });
    });

    async function handleSubmit(e, side) {
      e.preventDefault();
      const form = e.target;
      const statusElem = document.getElementById('form-status-' + side);

      // Honeypot spam check
      if (form.phone.value) {
        statusElem.textContent = 'Submission blocked as spam.';
        return false;
      }

      const data = {
        name: form.name.value.trim(),
        email: form.email.value.trim(),
        company: form.company.value.trim(),
        message: form.message.value.trim(),
        'g-recaptcha-response': grecaptcha.getResponse()
      };

      if (!data['g-recaptcha-response']) {
        statusElem.textContent = 'Please complete the CAPTCHA.';
        return false;
      }

      try {
        const response = await fetch('/api/send-ad-inquiry', {
          method: 'POST',
          headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(data)
        });

        const result = await response.json();
        if (response.ok) {
          statusElem.textContent = 'Thank you! Your inquiry has been sent.';
          form.reset();
          grecaptcha.reset();
        } else {
          statusElem.textContent = result.message || 'Failed to send inquiry.';
        }
      } catch (error) {
        statusElem.textContent = 'Error sending inquiry.';
        console.error(error);
      }
      return false;
    }
  </script>
</body>
</html>
